---
interface Props {
    messageContact?: string | null;
    isSection?: boolean;
}
const { messageContact = null, isSection = true } = Astro.props;

import { socials } from "@/data/social";
import config from "@/config/config";
---

<div class="bg-gray-200 relative overflow-hidden" id="contactSidebar">
    {
        isSection && (
            <button
                id="closeSidebarBtn"
                aria-label="Cerrar formulario de reserva"
                class="absolute top-4 right-4 z-20 p-2 text-gray-800 hover:text-primary transition-colors duration-300"
                aria-label="Cerrar contacto"
            >
                <svg
                    class="w-8 h-8"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M6 18L18 6M6 6l12 12"
                    />
                </svg>
            </button>
        )
    }

    {
        isSection && (
            <div class="ocean absolute inset-0 z-0">
                <div class="wave" />
                <div class="wave" />
            </div>
        )
    }
    <div class={`px-4 ${isSection ? "py-12" : "py-0"} relative z-10 h-full`}>
        <div class="w-full space-y-6">
            <!-- titulo -->
            {
                isSection && (
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold text-gray-800">
                            Contáctanos
                        </h2>
                        <p class="text-gray-600 mt-2">
                            Estamos aquí para ayudarte
                        </p>
                    </div>
                )
            }

            <!-- formulario -->
            <div
                class="bg-white sm:bg-white/90 sm:backdrop-blur-sm rounded-lg shadow-lg p-6 space-y-4"
            >
                <form class="space-y-4 text-primary">
                    <div>
                        <label
                            class="block text-gray-800 font-medium mb-1"
                            for="name">Nombre</label
                        >
                        <input
                            type="text"
                            id="name"
                            name="name"
                            required
                            class="w-full p-2 border-b border-gray-300 focus:outline-none focus:border-primary transition duration-200"
                            placeholder="Ingresa tu nombre"
                        />
                    </div>
                    <div>
                        <label
                            class="block text-gray-800 font-medium mb-1"
                            for="email">Correo Electrónico</label
                        >
                        <input
                            type="email"
                            id="email"
                            name="email"
                            required
                            class="w-full p-2 border-b border-gray-300 focus:outline-none focus:border-primary transition duration-200"
                            placeholder="Ingresa tu correo electrónico"
                        />
                    </div>
                    <div>
                        <label
                            class="block text-gray-800 font-medium mb-1"
                            for="message">Mensaje</label
                        >
                        <textarea
                            id="message"
                            name="message"
                            required
                            class="w-full p-2 border-b border-gray-300 focus:outline-none focus:border-primary transition duration-200"
                            rows="3"
                            placeholder="Escribe tu mensaje aquí"
                            value={messageContact?.trim() ?? ""}
                            >{messageContact?.trim() ?? ""}</textarea
                        >
                    </div>
                    <div class="pt-2">
                        <button
                            type="submit"
                            class="w-full py-2.5 bg-primary text-white rounded-lg hover:bg-primary/90 transition-all duration-300 font-semibold"
                        >
                            Enviar
                        </button>
                    </div>
                </form>
            </div>

            <!-- whatsapp -->
            <div
                class="bg-white sm:bg-white/90 sm:backdrop-blur-sm rounded-lg shadow-lg p-6 text-center"
            >
                <h3 class="text-xl font-semibold text-gray-800 mb-3">
                    ¿Prefieres WhatsApp?
                </h3>
                <p class="text-gray-600 mb-4 text-sm">
                    Escríbenos directamente para una respuesta más rápida
                </p>
                <a
                    href={socials.find(
                        (item) => item.name.toLowerCase() === "whatsapp",
                    )?.url}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center justify-center space-x-2 bg-green-500 hover:bg-green-600 text-white px-5 py-2.5 rounded-lg transition-colors duration-300"
                >
                    <svg
                        class="w-5 h-5"
                        fill="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"
                        ></path>
                    </svg>
                    <span>Chatear por WhatsApp</span>
                </a>
            </div>

            <!-- como llegar -->
            <div
                class="bg-white sm:bg-white/90 sm:backdrop-blur-sm rounded-lg shadow-lg p-6"
            >
                <h3
                    class="text-xl font-semibold text-gray-800 mb-3 text-center"
                >
                    Cómo Llegar
                </h3>
                <div class="aspect-video w-full rounded-lg overflow-hidden">
                    <iframe
                        title={`Como llegar a ${config.title}`}
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3566.770675474034!2d-65.20336182381959!3d-26.623796481195527!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94226487579f9c8d%3A0x9196f1acb7ee933!2sSW%20Tucuman%20Aventuras!5e0!3m2!1ses-419!2sar!4v1736727860412!5m2!1ses-419!2sar"
                        width="100%"
                        height="100%"
                        style="border:0;"
                        allowfullscreen=""
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                    >
                    </iframe>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const closeSidebarBtn = document.getElementById("closeSidebarBtn");

    if (closeSidebarBtn) {
        closeSidebarBtn.addEventListener("click", () => {
            // Obtener el sidebar y el overlay
            const sidebar = document.getElementById("contactSidebar");
            const overlay = document.getElementById("sidebarOverlay");

            // Añadir clase para la animación de salida
            sidebar?.classList.add("translate-x-full");
            overlay?.classList.add("opacity-0", "pointer-events-none");

            // Restaurar el scroll del body
            document.body.style.overflow = "";
        });
    }
</script>

<style>
    .ocean {
        height: 100%;
        background: linear-gradient(180deg, #E26128/5 0%, #E26128/30 100%);
    }

    .wave {
        background: url(https://s3-us-west-2.amazonaws.com/s.cdpn.io/85486/wave.svg)
            repeat-x;
        position: absolute;
        filter: invert(1);
        bottom: 0;
        width: 6400px;
        height: 198px;
        animation: wave 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) infinite;
        transform: translate3d(0, 0, 0);
    }

    .wave:nth-of-type(2) {
        bottom: 25px;
        animation:
            wave 7s cubic-bezier(0.36, 0.45, 0.63, 0.53) -0.125s infinite,
            swell 7s ease -1.25s infinite;
        opacity: 0.5;
    }

    @keyframes wave {
        0% {
            margin-left: 0;
        }
        100% {
            margin-left: -1600px;
        }
    }

    @keyframes swell {
        0%,
        100% {
            transform: translate3d(0, -25px, 0);
        }
        50% {
            transform: translate3d(0, 5px, 0);
        }
    }
</style>
